import pyodbc

# Database connection settings
server = '192.168.0.226'  # e.g., 'localhost\SQLEXPRESS'
database = 'Power_Usage_Alumac'
username = 'sa'
password = 'passwordpi'
driver = '{ODBC Driver 17 for SQL Server}'  # or appropriate driver for your setup

# Establish a connection to the database
conn = pyodbc.connect(f'DRIVER={driver};SERVER={server};DATABASE={database};UID={username};PWD={password}')

# Create a cursor object using the connection
cursor = conn.cursor()

# SQL Insert query
insert_query = """
INSERT INTO Office_Readings 
   (VoltageL1_v, VoltageL2_v, VoltageL3_v, CurrentL1_I, CurrentL2_I, CurrentL3_I, CurrentLn_I,
    TotalRealPower_kWh, TotalApparentPower_kWh, TotalReactivePower_kWh, TotalPowerFactor_kWh, Frequency_,
    TotalRealEnergy, TotalReactiveEnergy, TotalApparentEnergy)
VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
"""

# Values to be inserted
values = (415.0, 423.0, 411.0, 1.5, 1.6, 1.7, 1.8, 1000.0, 56.0, 1000.0, 6000.0, 49.8, 12356.0, 2101.0, 2202.0)

try:
    # Execute the insert query
    cursor.execute(insert_query, values)

    # Commit the transaction
    conn.commit()
    print("Data inserted successfully!")

except Exception as e:
    print(f"Error: {e}")
    conn.rollback()

finally:
    # Close the cursor and connection
    cursor.close()
    conn.close()